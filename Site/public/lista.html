<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="icon" type="image/png" href="./img/icone.png">
    <title>Lista de filmes</title>
</head>

<body onchange="myFunction()">
    <div class="navbar">
        <div class="icon-bar">
            <img class="button-menu" style="cursor: pointer;" onclick="Show()" src="./img/menu.png">
            <a href="./index.html"><img class="button-menu" src="./img/logo.png"></a>


        </div>
        <nav>
            <div class="logo">
                <a href="./index.html"><img src="./img/logo.png" alt="logo"></a>
            </div>
            <ul class="menu-area" id="nav-lists" value="0">
                <li><a href="./index.html">Home</a></li>
                <li><a href="./lista.html">Filmes</a></li>
                <li><a href="./chat.html">Chat</a></li>
                <li><a href="./sobre.html">Sobre</a></li>
                <li id="login"><a href="./login.html">Login</a></li>
                <li id="usuario" class="dropdown lista">
                    <a href="javascript:void(0)" class="dropbtn"><span id="perfil"></span></a>
                    <div class="dropdown-content">
                        <a href="#" onclick="logoff()">Sair</a>
                </li>
            </ul>
        </nav>
        </div>
        <br>
        <div class="container-lista-grande">
            <div class="container-lista-filmes">
                <div class="titulo">
                    <h1>Lista de Filmes</h1>
                </div>
                <div class="lista">
                    <img class="img-lista fica" id="0" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BMjZjNDU5YTktZjBlMS00YTRlLTg0YWMtMTBlMjViNmJiNDQ3XkEyXkFqcGdeQXVyMjUxODE0MDY@._V1_SX300.jpg" alt="tt0006907">
                    <img class="img-lista fica" id="10" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BNjEzYjIxMjQtNTgxOC00YzFhLWI0NTgtYTY0ZjYyOTg2NTRmXkEyXkFqcGdeQXVyNjMxODMyODU@._V1_SX300.jpg" alt="tt0019968">
                    <img class="img-lista cel-some" id="9" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BMDhiN2MwNjgtODMwNC00NzM2LWExNDMtNGYwYjlmM2Y0NTYzL2ltYWdlXkEyXkFqcGdeQXVyNjUzNzQ4NDQ@._V1_SX300.jpg" alt="tt0089736">
                    <img class="img-lista cel-some" id="6" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BYTFmY2ZmMzAtYWU4ZC00OWU1LWExNmItZmY2MGMzY2Q4MjJlXkEyXkFqcGdeQXVyOTI0MTUwNzA@._V1_SX300.jpg" alt="tt0004028">
                    <img class="img-lista tab-sumir" id="15" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BNjk4ZTQwN2EtNzc3Yy00M2U4LWJjZjUtZDE3NDAxZjQ2MTA2XkEyXkFqcGdeQXVyMDY4MzkyNw@@._V1_SX300.jpg" alt="tt0054791">
                </div>
                <br>
                <div class="lista">
                    <img class="img-lista fica" id="5" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BODEzOTllN2ItNDg2ZC00YWZhLTgwZmEtMDJkN2E2ZGU1NzVjXkEyXkFqcGdeQXVyMTE4MTQ1MjE@._V1_SX300.jpg" alt="tt0044214">
                    <img class="img-lista fica" id="13" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BZjM1YWM0MzEtYmMzNi00NzAzLTk1N2ItMWMxZGI3MWI4ZDc3XkEyXkFqcGdeQXVyNDY1NzU5NjY@._V1_SX300.jpg" alt="tt0011474">
                    <img class="img-lista cel-some" id="11" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BZjJmMjJiOWMtZmQyOS00MmExLTliMjgtNGIxNmMxOWJmMWE2XkEyXkFqcGdeQXVyMjM2ODYwMQ@@._V1_SX300.jpg" alt="tt0088629">
                    <img class="img-lista cel-some" id="16" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BNjY4YWM3N2YtZmY1NS00OTMwLTgwNzUtZTBlM2Y2NGE5YzExXkEyXkFqcGdeQXVyMTQ3Njg3MQ@@._V1_SX300.jpg" alt="tt0087429">
                    <img class="img-lista tab-sumir" id="1" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BMTMyODMxMTg3OV5BMl5BanBnXkFtZTcwMDI3MjE5Mw@@._V1_SX300.jpg" alt="tt0026959">
                </div>
                <br>
                <div class="lista">
                    <img class="img-lista fica" id="7" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BNTZmMGYyNTItY2JhMy00MWMxLTk5YWItMTEzNzNkZWRjMTc0XkEyXkFqcGdeQXVyMTQ3Njg3MQ@@._V1_SX300.jpg" alt="tt0056531">
                    <img class="img-lista fica" id="14" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BMzUzMWMzYTItYzMwMy00NGZiLWIyNzktZDRhMWIzMDRlZGUwXkEyXkFqcGdeQXVyMTY5Nzc4MDY@._V1_SX300.jpg" alt="tt0041396">
                    <img class="img-lista cel-some" id="8" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BMWU4N2FjNzYtNTVkNC00NzQ0LTg0MjAtYTJlMjFhNGUxZDFmXkEyXkFqcGdeQXVyNjc1NTYyMjg@._V1_SX300.jpg" alt="tt0050083">
                    <img class="img-lista cel-some" id="2" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BMmNmNjdiMmEtMWM3Zi00ODNjLWJmNjItMmY5MGJmMTQ3ZmI4XkEyXkFqcGdeQXVyNzc5MjA3OA@@._V1_SX300.jpg" alt="tt0094100">
                    <img class="img-lista tab-sumir" id="19" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BYWFjOTkyYWUtY2ViNS00M2JmLTg2NDYtZWYwMTIxMTU2NWZkXkEyXkFqcGdeQXVyMTA3NzE5MzE@._V1_SX300.jpg" alt="tt0060717">
                </div>
                <br>
                <div class="lista">
                    <img class="img-lista fica" id="4" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BNmFkMjRlNjEtMDY4NC00ZDc2LWE2NTMtMjIzMWMxOTM1MmZmXkEyXkFqcGdeQXVyMDMxMjQwMw@@._V1_SX300.jpg" alt="tt0023124">
                    <img class="img-lista fica" id="18" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BNTg5ZTkyNmItYjYwZC00NTM4LTg2NWItMjEwODczZmUyZjFjXkEyXkFqcGdeQXVyNzcyMTE4NzU@._V1_SX300.jpg" alt="tt0062588">
                    <img class="img-lista cel-some" id="12" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BZDdlMDdjMjEtZjg0MC00Y2JlLThhNzItNmI4ZTgxODI4YzczXkEyXkFqcGdeQXVyMTQ2MjQyNDc@._V1_SX300.jpg" alt="tt0095539">
                    <img class="img-lista cel-some" id="3" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BNGRiNDUxMjQtZDBjYi00MzYxLWFlZmItMzVkZjNlMDRiZDVmXkEyXkFqcGdeQXVyOTI2MjI5MQ@@._V1_SX300.jpg" alt="tt0044601">
                    <img class="img-lista tab-sumir" id="17" onclick="filme_individual(this.id)" src="https://m.media-amazon.com/images/M/MV5BMTk3MjI1NTg0Ml5BMl5BanBnXkFtZTcwODAwODk0MQ@@._V1_SX300.jpg" alt="tt0057939">
                </div>
                <br>
                <button class="botao-random" onclick="pesquisar_filme()"><img src="./img/random.png"</button>

            </div>
        </div>
        <br>
        <br>
        <div class="container-geral-forum">
            <div class="container-forum">
                <div class="graph">
                    <canvas id="myChartBar"></canvas>
                </div>
            </div>
        </div>
        <br>
        <br>
        <br>
        <br>
        <div class="footer">
            <br>
            <br>
            <p>Filme Véio © 2021. Todos direitos reservados.</p>
            <br>
            <br>
        </div>
</body>
<script src="./js/main.js"></script>
<script>
    function Grafico() {

        const labelsBar = lista_nomes;

        const dataBar = {
            labels: labelsBar,
            datasets: [{
                label: "Notas Filmes",
                backgroundColor: ["#ff7700", "#FAC710", "#C68A02"],
                borderColor: "black",
                data: lista_notas,
            }, ],
        }

        const configBar = {
            type: "bar",
            data: dataBar,
            options: {
                maintainAspectRatio: false
            },
        }
        var myChartBar = new Chart(document.getElementById("myChartBar"), configBar);
    }

    'use strict';
    window.onload = ao_entrar;
    let id_filme = " ";
    let id_title = " ";
    let id_src = " ";
    var lista_nomes = [];
    var lista_notas = [];

    function ao_entrar() {
        entrar_pagina()
        pesquisar_filme()
    }

    function entrar_pagina() {
        if (sessionStorage.login_usuario_meuapp != undefined) {
            usuario.style.display = 'block';
            login.style.display = 'none';
            perfil.innerHTML = sessionStorage.login_usuario_meuapp
        }
    }

    function gerar_numero() {
        var numero_random = Math.floor(Math.random() * 100000)
        for (var contador = String(numero_random).length; contador < 7; contador++) {
            numero_random = '0' + numero_random;
        }
        id_filme = 'tt' + numero_random;
    }

    function filme_individual(id_mostrado) {
        var id_filme_individual = document.getElementById(id_mostrado);
        id_title = id_filme_individual.alt;
        id_src = id_filme_individual.src;
        window.location.href = `./filme-individual.html?id=${id_title}`;
    }

    async function pesquisar_filme() {
        var cont = 0;
        while (cont < 20) {
            var imagem_loop = document.getElementById(`${cont}`);
            gerar_numero();
            //let api_key = '9b975cfc'
            //let api_key = 'e0620bd4';
            let api_key = '2888d6ef';
            const url = `https://www.omdbapi.com/?apikey=${api_key}&i=${id_filme}`;
            const data = await fetch(url);
            const response = await data.json();
            const poster = response.Poster;
            const imdb = response.imdbID;
            const title = response.Title;
            const imdbRating = response.imdbRating;
            var nota_filme = imdbRating;
            if (poster == 'N/A') {
                cont--
            } else {
                if (nota_filme == 'N/A') {
                    nota_filme = 5;
                }
                imagem_loop.src = `${poster}`;
                imagem_loop.alt = `${imdb}`;
                lista_notas.push(Number(nota_filme));
                lista_nomes.push(title);
            }
            cont++
        }
        Grafico()
    }


    function myFunction(x) {
        if (x.matches) { // If media query matches
            navList.classList.add("_Menus-show");
            navList.value = 1;
        } else {
            navList.classList.remove("_Menus-show");
            navList.value = 0;
        }
    }

    var x = window.matchMedia("(max-width: 660px)")
    myFunction(x) // Call listener function at run time
    x.addListener(myFunction) // Attach listener function on state changes
</script>

</html>